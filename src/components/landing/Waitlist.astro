---
import Text from "@/components/fundations/elements/Text.astro";
import Button from "@/components/fundations/elements/Button.astro";
import Wrapper from "@/components/fundations/containers/Wrapper.astro";
---

<section id="waitlist" class="py-10">
  <Wrapper variant="standard">
    <div class="bg-gray-50 rounded-xl px-8 py-8">
      <div class="max-w-xl mx-auto text-center space-y-3">


      <Text tag="h2" variant="displaySM">
        Get the Madrid Landing Kit
      </Text>


<form
  method="POST"
  action="https://e8cc70cd.sibforms.com/serve/MUIFAA6LVktcBeqZuSgfFASiqmGBIqK0sizA1aOP9d5iSsLTGyMgm-2eq_nATV8fY9n7mOpkJTCsZxk1SaeqCCpI4bqdmTITARiONtsa6G1rLvlsjMxvoCg9iIfpmOaDThFA4kF9b0AKna1Lrnw_k4xMfJ2ny_4idUIki7_RHlAbkq_u8vfPiAhUvCENe0Qw-8gkvhOHGZUJ2N6zow=="
  class="max-w-md mx-auto"
>
  <input
    type="email"
    name="EMAIL"
    required
    placeholder="Your email address"
    class="w-full rounded-md border px-4 py-3 text-sm mb-3"
  />
<Button
  type="button"
  id="waitlist-submit"
  variant="accent"
  size="base"
  class="w-full"
>
  Get the checklist
</Button>
  <input type="hidden" name="locale" value="es" />
</form>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("waitlist-form");
    const button = document.getElementById("waitlist-submit");

    if (!form || !button) return;

    button.addEventListener("click", async () => {
      const formData = new FormData(form);

      try {
        const res = await fetch("/api/subscribe", {
          method: "POST",
          body: formData,
        });

        if (res.ok) {
          alert("Thanks! Check your inbox.");
          form.reset();
        } else {
          alert("Something went wrong.");
        }
      } catch (err) {
        console.error(err);
        alert("Network error.");
      }
    });
  });
</script>

      <Text tag="p" variant="textXS" class="text-base-400">
        No spam. Unsubscribe anytime.
      </Text>

    </div>
  </Wrapper>
</div>

</section>


